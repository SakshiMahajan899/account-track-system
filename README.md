# Bank Application

## Description

This project simulates a simple bank account using Java, focusing on functionalities such as transferring and withdrawing money from an account. It supports payments using either debit or credit cards, with a 1% extra charge for transactions made with a credit card. The project also includes API endpoints to interact with the account, ensuring secure access through oauth token based authentication and authorization.

## Bank Application YAML

Within the resources/yaml folder, you'll find the AccountServiceAPI.yaml file, which details all the endpoints provided by the Bank Application.


## Requirements

- Eclipe/Intellij
- Java17
- Maven
- Git
- Docker (Optional)

## Steps to Run the Application

1. **Clone the repository:**
   ```bash
   git clone https://github.com/SakshiMahajan899/bank-application.git
   cd bank-application

2. **Build the project:**
   mvn clean install

3. **SSL Certificate**
To secure the API endpoints with SSL, keystore.p12 is placed in the resources folder of your project.

4. **Run the application:**
   mvn spring-boot:run

5. **Access the application:**
   - https://localhost:8080

## Using H2 Database 
 
  This project uses an H2 in-memory database for development and testing purposes. 

  ### Accessing H2 Database Console

   - Go to http://localhost:8080/h2-console.
   - JDBC Url is jdbc:h2:mem:recipedb
   - User Name: sa
   - Password: password
   - Click on "Connect" to access the H2 database console.

## Spring Security  
   
   - This application uses Spring Authorization Server framework that helps to create own standards-based OAuth2 Authorization Server in below mentioned repo.
        https://github.com/SakshiMahajan899/oauth-authorization-server.git
   - To access the secure endpoints, you'll need to provide jwt token generated by using authorization server along with request details.
   - Below diagram shows how authentication and authorization works in Bank application
     ![Untitled ss drawio](https://github.com/user-attachments/assets/6d00646a-b50f-4535-ac3b-db87ab1cc783)


 

## API Endpoints

### Get All Recipes

- **URL:** `/api/accounts/balance`
- **Method:** `POST`
- **Description:** Retrieve a list of all recipes.
- **Response:**
  ```json
  [
     {
        "id": 1,
        "name": "Chicken Alfredo",
        "ingredients": [
            "chicken, fettuccine, cream, parmesan, garlic"
        ],
        "servings": 2,
        "instructions": "Cook fettuccine. In a separate pan, saut√© garlic, then add cream and cheese. Add cooked chicken and fettuccine.",
        "vegetarian": false
    }
  ]

### Add New Recipe

- **URL:** `/api/recipes`
- **Method:** `POST`
- **Description:** Add a new recipe to the collection..
- **Request Body:**
  ```json
  {
        "name": "Spaghetti Bolognese",
        "ingredients": [
            "spaghetti",
           "tomato sauce"
           ],
        "servings": 2,
        "instructions": "Cook spaghetti. Mix with tomato sauce. Combine and serve",
        "vegetarian": true
    }
- **Response:**
  ```json
  {
    "id": 4,
    "name": "Spaghetti Bolognese",
    "ingredients": [
        "spaghetti",
        "tomato sauce"
    ],
    "servings": 2,
    "instructions": "Cook spaghetti. Mix with tomato sauce. Combine and serve",
    "vegetarian": true
   }


### Update Recipe

- **URL:** `/api/recipes/:id`
- **Method:** `PUT`
- **Description:** Update an existing recipe by its ID.
- **Request Body:**
  ```json
  {
    "name": "Potato Gratin",
    "ingredients": [
        "potatoes, cream, cheese, garlic, thyme"
    ],
    "servings": 4,
    "instructions": "Layer potatoes with cream and cheese, bake until golden and bubbly.",
    "vegetarian": true
   }
- **Response:**
  ```json
  {
    "id": 1,
    "name": "Potato Gratin",
    "ingredients": [
        "potatoes, cream, cheese, garlic, thyme"
    ],
    "servings": 4,
    "instructions": "Layer potatoes with cream and cheese, bake until golden and bubbly.",
    "vegetarian": true
   }



### Delete Recipe

- **URL:** `/api/recipes/:id`
- **Method:** `DELETE`
- **Description:** Delete a specific recipe by its ID.



### Filter Recipes

#### All Vegetarian Recipes

- **URL:** `/api/recipes/filter`
- **Method:** `GET`
- **Description:** Retrieve all vegetarian recipes.
- **Query Parameter:** `vegetarian=true`
- **Response:**
  ```json
  [
    {
      "id": 1,
      "name": "Vegetable Stir Fry",
      "ingredients": ["broccoli", "carrots", "bell peppers", "soy sauce"],
      "servings": 2,
      "instructions": "Stir fry vegetables in a pan with soy sauce.",
      "vegetarian": true,
    }
  ]

#### Serve 4 Persons and Have "Potatoes" as an Ingredient

- **URL:** `/api/recipes/filter`
- **Method:** `GET`
- **Description:** Retrieve recipes that can serve 4 persons and contain "potatoes" as an ingredient.
- **Query Parameter:** `servings=4`
- **Query Parameter:** `ingredientInclude=Potatoes` 
- **Response:**
  ```json
  [
    {
      "id": 1,
      "name": "Vegetable Stir Fry",
      "ingredients": ["Potatoes", "carrots", "bell peppers", "soy sauce"],
      "vegetarian": true,
      "servings": 4,
      "instructions": "Stir fry vegetables in a pan with soy sauce."
    }
  ]

#### Recipes Without "Salmon" as an Ingredient and Have "Oven" in the Instructions

- **URL:** `/api/recipes/filter`
- **Method:** `GET`
- **Description:** Retrieve recipes without "salmon" as an ingredient that have "oven" in the instructions.
- **Query Parameter:** `instructionsText=oven`
- **Query Parameter:** `ingredientExclude=Salmon` 
- **Response:**
  ```json
  [
    {
        "id": 1,
        "name": "Spaghetti",
        "ingredients": [
            "spaghetti",
            "tomato sauce"
        ],
        "vegetarian": true,
        "servings": 2,
        "instructions": "Cook spaghetti. Mix with tomato sauce. Put in oven for 5 minutez  and serve"
    }
  ]

## Test Coverage

   ### Unit Tests (UT) & Integration Tests (IT)

1. **Scope**
   - Focuses on individual functions, methods, or classes.
   - Focuses on the interactions between units and their dependencies.

3. **Coverage**
   - Aims to cover all possible code paths, including edge cases.
   - Aims to cover all critical integration points and workflows.

4. **Framework**
   - Mockito

Test Coverage with UT and IT is more than 90% for Recipe Application.
![image](https://github.com/user-attachments/assets/731141f3-2748-46c0-8124-045d7ee990ec)



## Continuous Integration and Deployment

Within the bank-application/.github/workflows/ directory, you'll find the ci-cd.yml file, which is used to build the code & deploy the image to dockerHub.
![image](https://github.com/user-attachments/assets/c179917b-9f5e-4194-958e-a189d408a9c0)



  - Pipeline link -  https://github.com/SakshiMahajan899/bank-application/actions/runs/12998897915/job/36253023235
  - Also refer the below screenprint for the tag creation of the Bank Application in DockerHub
    ![image](https://github.com/user-attachments/assets/71c49f78-fb65-41ae-b0fa-9101eea2ab3c)


